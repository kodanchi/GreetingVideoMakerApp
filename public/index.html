<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ğŸ‰ ØµØ§Ù†Ø¹ ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ØªÙ‡Ù†Ø¦Ø©</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet" />
</head>
<body class="bg-dark text-white p-4">

  <div class="container text-center">
    <h2 class="mb-4">ğŸ‰ ØµØ§Ù†Ø¹ ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ØªÙ‡Ù†Ø¦Ø©</h2>

    <input type="url" id="videoUrl" class="form-control my-3" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (MP4)">
    <input type="text" id="greeting" class="form-control my-3" placeholder="Ø§Ù„ØªÙ‡Ù†Ø¦Ø© (Ù…Ø«Ø§Ù„: Ø¹ÙŠØ¯ÙƒÙ… Ù…Ø¨Ø§Ø±Ùƒ)">
    <input type="text" id="greeter" class="form-control my-3" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ÙØ±Ø³Ù„ (Ù…Ø«Ø§Ù„: Ù…Ø¹ ØªØ­ÙŠØ§Øª Ù…Ø­Ù…Ø¯)">

    <button class="btn btn-primary" onclick="generateVideo()">âœ¨ Ø§Ù†Ø´Ø¦ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</button>

    <div id="status" class="mt-3"></div>
    <a id="downloadLink" class="btn btn-success mt-3" style="display:none">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</a>
  </div>

  <script>
    async function generateVideo() {
      const videoUrl = document.getElementById("videoUrl").value.trim();
      const greeting = document.getElementById("greeting").value.trim();
      const greeter = document.getElementById("greeter").value.trim();
      const status = document.getElementById("status");
      const link = document.getElementById("downloadLink");

      if (!videoUrl || !greeting || !greeter) {
        alert("ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„");
        return;
      }

      status.innerText = "â³ Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ...";
      link.style.display = "none";

      try {
        const response = await fetch("https://ffmpeg-vercel-api.vercel.app/api/generate", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ videoUrl, greeting, greeter })
        });

        if (!response.ok) throw new Error("ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ");

        const blob = await response.blob();
        const videoURL = URL.createObjectURL(blob);
        link.href = videoURL;
        link.download = "greeting.mp4";
        link.style.display = "inline-block";
        status.innerText = "âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ!";

      } catch (err) {
        console.error(err);
        status.innerText = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ";
      }
    }
  </script>

</body>
</html>

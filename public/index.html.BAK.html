<!DOCTYPE html>
<html lang="en" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Greeting Video Generator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    @font-face {
      font-family: 'HONORSansArabicUI';
      src: url('font/HONORSansArabicUI-B.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }
    body {
      background-color: #121212;
      color: white;
      font-family: 'HONORSansArabicUI', sans-serif;
    }
    .video-thumb {
      cursor: pointer;
      border: 2px solid transparent;
      transition: border-color 0.2s;
    }
    .video-thumb:hover, .video-thumb.selected {
      border-color: #0d6efd;
    }
    .greeting-btn {
      margin: 5px;
    }
    #outputVideo {
      max-height: 360px;
      border: 2px solid #0d6efd;
      margin-top: 20px;
    }
    #downloadBtn, #whatsappBtn {
      display: none;
    }
    #successMsg {
      display: none;
      font-size: 1.25rem;
      color: #28a745;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <h2 class="text-center mb-4">ğŸ¥ ØµØ§Ù†Ø¹ ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ØªÙ‡Ù†Ø¦Ø©</h2>

    <!-- Greeting selection -->
    <div class="mb-4 text-center">
      <h5>Ø§Ø®ØªØ± Ø§Ù„ØªÙ‡Ù†Ø¦Ø©</h5>
      <div id="greeting-options">
        <button class="btn btn-outline-light greeting-btn">ÙƒÙ„ Ø¹Ø§Ù… ÙˆØ§Ù†ØªÙ… Ø¨Ø®ÙŠØ±</button>
        <button class="btn btn-outline-light greeting-btn">Ø¹ÙŠØ¯ÙƒÙ… Ù…Ø¨Ø§Ø±Ùƒ</button>
        <button class="btn btn-outline-light greeting-btn">ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ø·Ø§Ø¹ØªÙƒÙ…</button>
      </div>
    </div>

    <!-- Custom greeting text -->
    <div class="mb-4 text-center">
      <h5>Ø§ÙƒØªØ¨ ØªÙ‡Ù†Ø¦ØªÙƒ Ø§Ù„Ø®Ø§ØµØ© (ØªØ¸Ù‡Ø± ÙÙŠ Ù…Ù†ØªØµÙ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ)</h5>
      <input type="text" id="customGreeting" maxlength="50" placeholder="Ù…Ø«Ø§Ù„: Ø¹ÙŠØ¯ Ø³Ø¹ÙŠØ¯!" class="form-control mt-2" dir="rtl" oninput="this.value=this.value.replace(/[^\u0600-\u06FF\s]/g,'')" />
    </div>

    <!-- Greeter name -->
    <div class="mb-4 text-center">
      <h5>Ø§Ø³Ù… Ø§Ù„Ù…ÙØ±Ø³Ù„ (ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„)</h5>
      <input type="text" id="greeterName" maxlength="30" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø¹ ØªØ­ÙŠØ§Øª Ù…Ø­Ù…Ø¯" class="form-control mt-2" dir="rtl" oninput="this.value=this.value.replace(/[^\u0600-\u06FF\s]/g,'')" />
    </div>

    <!-- Video selection -->
    <div class="mb-4">
      <h5 class="text-center">Ø§Ø®ØªØ± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</h5>
      <div class="row g-3 justify-content-center" id="video-gallery">
        <div class="col-6 col-md-3">
          <img src="thumbnails/thumb1.jpg" class="img-fluid video-thumb" data-src="videos/video1.mp4" />
        </div>
        <div class="col-6 col-md-3">
          <img src="thumbnails/thumb2.jpg" class="img-fluid video-thumb" data-src="videos/video2.mp4" />
        </div>
        <div class="col-6 col-md-3">
          <img src="thumbnails/thumb3.jpg" class="img-fluid video-thumb" data-src="videos/video3.mp4" />
        </div>
        <div class="col-6 col-md-3">
          <img src="thumbnails/thumb4.jpg" class="img-fluid video-thumb" data-src="videos/video4.mp4" />
        </div>
      </div>
    </div>

    <!-- Processing + preview -->
    <div class="text-center">
      <button class="btn btn-primary" onclick="generateVideo()">Ø§Ù†Ø´Ø¦ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</button>
      <progress id="progressBar" value="0" max="100" class="mt-3" style="width: 100%; display: none;"></progress>
      <p id="status"></p>
      <video id="outputVideo" controls class="w-100" style="display: none;"></video>
      <a id="downloadBtn" class="btn btn-success mt-3" download="greeting.mp4">ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</a>
      <a id="whatsappBtn" class="btn btn-outline-light mt-3" target="_blank">ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</a>
      <div id="successMsg">ğŸ‰ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ù…Ø´Ø§Ø±ÙƒØªÙ‡ Ù…Ø¹ Ø£Ø­Ø¨Ø§Ø¦Ùƒ.</div>
    </div>
  </div>

  <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.11.6/dist/ffmpeg.min.js"></script>
  <script src="script.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }

    // Set WhatsApp share link dynamically after rendering
    function updateWhatsAppLink(url) {
      const whatsappBtn = document.getElementById('whatsappBtn');
      const message = encodeURIComponent('ğŸ¥ Ø´ÙˆÙÙˆØ§ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù„ÙŠ Ø³ÙˆÙŠØªÙ‡ Ù„ÙƒÙ…!');
      whatsappBtn.href = `https://wa.me/?text=${message}%20${encodeURIComponent(url)}`;
      whatsappBtn.style.display = 'inline-block';
    }
  </script>
</body>
</html>
